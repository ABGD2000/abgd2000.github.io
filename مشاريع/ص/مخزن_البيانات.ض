
فارغ = null
// فهرس
// طبق
// سلسلة
// طابور
// الطفو
// الغوص
// مجموعة

وحدة  كثافة{
عنصر = فارغ 
قيمة = 0
مؤشر_يمين=مؤشر()
مؤشر_شمال=مؤشر()
 دالة مؤشر نوع
مرر setpointer(this,"كثافة")
تمام
}
وحدة الطفو{
شرظ_الطفو=""
مؤشر_الطقو=كثافة.مؤشر()

}

وحدة مخزن_فيل {
تحميل "postgresqllib.ring"

اسم_المستخدم=""
كلمة_المرور=""
الضيف=""
الجزء=""



 الجدول = فارغ
اسم_الجدول = فارغ
المخزن= فارغ
البيانات = []
المخزون=[]
الأعمدة = []
حالة_الأتصال = 0

دالة تنفيذ الجملة

 الجملة  =print2str (الجملة)
	النتيجة=  PQexec(المخزن, الجملة)
	جطأ=""
	البيانات = []
		لو PQresultStatus(النتيجة) != PGRES_TUPLES_OK
		خطأ = PQerrorMessage(المخزن)
	لا
		عدد_الصفوف   = PQntuples(النتيجة)
		عدد_الأعمدة = PQnfields(res)
		من س=1 إلى عدد_الصفوف
			صف = []
			من ص=1 إلى عدد_الأعمدة
				صف[PQfname(النتيجة, ص-1)] = PQgetvalue(النتيجة, س-1, ص-1)
			دور
			 البيانات + صف 
		دور
	تم
	مسح_النتيجة=1 PQclear(النتيجة)
	لو خطأ = ""
	مرر البيانات
	لا
	مرر خطأ
	تم

دالة الأتصال اسم_المخزن
لو (isnull(المخزن))

جملة_الاتصال  = " user="     + اسم_المستخدم
	جملة_الاتصال += " password=" + كلمة_المرور
	جملة_الاتصال += " dbname="   + اسم_المخزن
	جملة_الاتصال += " port="     + الجزء
المخزن =  PQconnectdb(جملة_الاتصال)
تنفيذ("SET CHARACTER SET utf8")

حالة_الأتصال = 1
تم


}

وحدة مخزن_دلفين {
تحميل "mysqllib.ring"

القيم = " VALUES "
أدخل = " INSERT INTO "
تبديل = " INSERT OR REPLACE INTO  " 

تعديل = " UPDATE "
أجعل = " SET "

أحذف = "  Delete From "
أمسح = "  Delete From "
مسح = "  Delete From "

 إنشاء = "CREATE TABLE "
لولا = " IF NOT EXISTS "

صحيح = " INTEGER "
حقيقي =" REAL "
نص = " TEXT "
تاريخ = " Datetime "
علامة = " Bit "
أساس= "  PRIMARY KEY "

أستعلم = " SELECT "
أشهد = " SELECT "
أحضر = " SELECT "
نسخ = " INTO "
ك = " AS "
بلقب = " AS "
عن = " FROM "
دمج = " JOIN "
شمال = " LEFT OUTER "
يسار =  " LEFT OUTER "
يمين =   " RIGHT OUTER " 
نواة =  " INNER "
جميع = " FULL OUTER "
لما = " ON "
عندما = " WHERE "
مثل = " like "
داخل = " IN "
بين = " BETWEEN "


حد = " limit "
تجميع  = " GROUP "
ترتيب = " order "
حسب = " by "
بشرط = " having "
تنزلي = " desc "
تصاعدي = " asc "
و = " and "
أو = " or "
عكس = " not "

أحاد = " Distinct "
وحيد = " Distinct "

أكبر = "max"
أضغر = "min"
متوسط = "avg"
عدد = "count"
مجموع = "sum"


اسم_المستخدم=""
كلمة_المرور=""
الضيف=""
الجزء=""



 الجدول = فارغ
اسم_الجدول = فارغ
المخزن = فارغ
البيانات = []
المخزون=[]
الأعمدة = []
حالة_الأتصال = 0
دالة تنفيذ الجملة

 الجملة  =print2str (الجملة)
	مرر  mysql_query(المخزن, الجملة)


دالة الأتصال اسم_المخزن
لو (isnull(المخزن))
المخزن =  ysql_init()
تنفيذ("SET CHARACTER SET utf8")
أفتح_مخزن( اسم_المخزن)
حالة_الأتصال = 1
تم
مرر حالة_الأتصال
تمام


دالة هات_الكل 
مرر  هات_البيانات("select * from "+ اسم_الجدول + "; ")
تمام
دالة هات_عدد (عدد) 
مرر  هات_البيانات("select * from "+ اسم_الجدول + "  limit  " + عدد +"; ")
تمام

دالة هات_البيانات جملة_البحث

	 ج_الكل =  جملة_البحث 
	 شوف المخزن
	 شوف سطر
	  شوف ج_الكل 
     المخزون =  تنفيذ(ج_الكل)
 
لو الجدول != فارغ  && طول(المخزون) != 0
طول_الأعمدة = طول(المخزون[1])
الجدول.رأس_البيانات=[]
شوف سطر 
شوف المخزون[1][1][1]
الجدول.setColumnCount(طول_الأعمدة)
	الجدول.ضع_بيانات(المخزون)
  
     تم
     مرر المخزون
     تمام

خاص

دالة أفتح_مخزن اسم_المخزن

   mysql_connect(المخزن,الضيف , اسم_المستخدم , كلمة_المرور ,اسم_المخزن)
تمام

}

وحدة مخزن_خفيف{
تحميل "sqlitelib.ring"



القيم = " VALUES "
أدخل = " INSERT INTO "
تبديل = " INSERT OR REPLACE INTO  " 

تعديل = " UPDATE "
أجعل = " SET "

أحذف = "  Delete From "
أمسح = "  Delete From "
مسح = "  Delete From "

 إنشاء = "CREATE TABLE "
لولا = " IF NOT EXISTS "

صحيح = " INTEGER "
حقيقي =" REAL "
نص = " TEXT "
تاريخ = " Datetime "
علامة = " Bit "
أساس= "  PRIMARY KEY "
مطلوب = " NOT NULL "

أستعلم = " SELECT "
أشهد = " SELECT "
أحضر = " SELECT "
نسخ = " INTO "
ك = " AS "
بلقب = " AS "
عن = " FROM "
دمج = " JOIN "
شمال = " LEFT OUTER "
يسار =  " LEFT OUTER "
يمين =   " RIGHT OUTER " 
نواة =  " INNER "
جميع = " FULL OUTER "
لما = " ON "
عندما = " WHERE "
مثل = " like "
داخل = " IN "
بين = " BETWEEN "


حد = " limit "
تجميع  = " GROUP "
ترتيب = " order "
حسب = " by "
بشرط = " having "
تنزلي = " desc "
تصاعدي = " asc "
و = " and "
أو = " or "
عكس = " not "

أحاد = " Distinct "
وحيد = " Distinct "

أكبر = "max"
أضغر = "min"
متوسط = "avg"
عدد = "count"
مجموع = "sum"

اسم_المستخدم=""
كلمة_المرور=""
الضيف=""
الجزء=""

 الجدول = فارغ
اسم_الجدول = فارغ
المخزن = فارغ
البيانات = []
المخزون=[]
الأعمدة = []
حالة_الأتصال = 0

دالة عشري(الصحيح,جزء)
مرر " decimal"+"("+الصحيح+","+جزء+") "
تمام

دالة تنفيذ الجملة

 الجملة  =print2str (الجملة)
	مرر  sqlite_execute(المخزن, الجملة)

دالة الأتصال اسم_المخزن
لو (isnull(المخزن))
المخزن =  sqlite_init()
تنفيذ("SET CHARACTER SET utf8")
أفتح_مخزن( اسم_المخزن)
حالة_الأتصال = 1
تم
مرر حالة_الأتصال
تمام

دالة ضع فهرس_البيانات

تمام
دالة الإنشاء

 ج_الإنشاء = 
 " CREATE TABLE IF NOT EXISTS " +اسم_الجدول +" (    "     

//
ط_ب=طول(البيانات)



من رقم=1 إلى طول(الأعمدة)
لو ط_ب>=رقم
لو isnumber(البيانات[رقم]) 
لو  isdigit(""+البيانات[رقم])
ج_الإنشاء +=  الأعمدة[رقم] +" INTEGER" +" , " 
لا
ج_الإنشاء +=  الأعمدة[رقم] +"  DECIMAL(15, 5)" +" , "
تم
لا
ج_الإنشاء += الأعمدة[رقم] +"  VARCHAR(10000) " +" , " 
تم
لا
ج_الإنشاء += الأعمدة[رقم] +"  VARCHAR(10000) " +" , " 
تم
دور
ج_الإنشاء +=      "  المعرف INTEGER PRIMARY KEY AUTOINCREMENT)" 

 تنفيذ(ج_الإنشاء)
تمام
دالة الحفظ بيان
ج_الحفظ = أدخل +  اسم_الجدول     + "  ( " +الأعمدة[1] 
من رقم_عمود=2 إلى طول(الأعمدة) ج_الحفظ += " , "+ الأعمدة[رقم_عمود]  دور
ج_الحفظ +=") "+القيم+" ( '"
ج_الحفظ += بيان[1] 
من رقم=2 إلى طول(بيان) ج_الحفظ +="','"+بيان[رقم] دور


ج_الحفظ +="')"
			تنفيذ(ج_الحفظ)
					
					هات_الكل()
				aLANGUAGE=[]
					aLANGUAGE[:INFOS]="المعلومات"
					aLANGUAGE[:RECORD_ADDED] = "تمت عملية الحفظ بنجاح"
					// msgBox(aLANGUAGE[:INFOS],aLANGUAGE[:RECORD_ADDED],"green")

					مرر 1
تمام
دالة هات_الكل 
مرر  هات_البيانات("select * from "+ اسم_الجدول + "; ")
تمام
دالة هات_عدد (عدد) 
مرر  هات_البيانات("select * from "+ اسم_الجدول + "  limit  " + عدد +"; ")
تمام
دالة هات_البيانات جملة_البحث

	 ج_الكل =  جملة_البحث 
	 شوف المخزن
	 شوف سطر
	  شوف ج_الكل 
     المخزون =  تنفيذ(ج_الكل)
 
لو الجدول != فارغ  && طول(المخزون) != 0
طول_الأعمدة = طول(المخزون[1])
الجدول.رأس_البيانات=[]
شوف سطر 
شوف المخزون[1][1][1]
الجدول.setColumnCount(طول_الأعمدة)
	الجدول.ضع_بيانات(المخزون)
  
     تم
     مرر المخزون
     تمام
     
دالة أمسح الجدول , اسم_الجدول , اسم_المحدد

     ر_الصف = الجدول.CurrentRow()
     المحدد = Table.item(nrow,0).text() 
     الجدول.removerow(ر_الصف)
     ج_المسح = "delete from اسم_الجدول where اسم_المحدد = " + المحدد   
     sqlite_execute(المخزن,ج_المسح)
     هات_الكل()
تمام

دالة الأغلاق
	sqlite_close(المخزن)
	المخزن= null
تمام

خاص

دالة أفتح_مخزن اسم_المخزن

   sqlite_open(المخزن, اسم_المخزن)
تمام

}






