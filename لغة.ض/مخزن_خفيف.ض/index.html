<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> مخزن_خفيف.ض</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f4f4f9;
            margin: 0;
            direction: rtl; /* لضمان دعم اللغة العربية */
        }
        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 800px; /* لتحديد عرض المحتوى */
            width: 90%;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .content-area {
            background-color: #e9ecef;
            border: 1px solid #ced4da;
            border-radius: 5px;
            padding: 15px;
            text-align: right; /* المحاذاة لليمين للمحتوى العربي */
            font-size: 14px;
            white-space: pre-wrap; /* للحفاظ على التنسيق والمسافات */
            max-height: 400px; /* للتحكم في ارتفاع منطقة المحتوى */
            overflow-y: auto; /* لإضافة شريط تمرير إذا كان المحتوى طويلاً */
            line-height: 1.6;
            color: #495057;
        }
        .buttons-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        button:hover {
            background-color: #0056b3;
        }
        button i {
            font-size: 18px;
        }
        .filename {
            font-weight: bold;
            color: #28a745;
            display: block;
            margin-bottom: 15px;
        }
        .status-message {
            margin-top: 15px;
            font-size: 14px;
            color: #28a745;
            display: none; /* مخفي افتراضياً */
        }
    </style>
</head>
<body>

<div class="container">
    <h1> مخزن_خفيف.ض </h1>
    <span class="filename">اسم الملف: مخزن_خفيف.ض</span>

    <div id="fileContentDisplay" class="content-area">
        </div>

    <div class="buttons-container">
        <button onclick="copyContent()"><i class="fas fa-copy"></i> نسخ المحتوى</button>
        <button onclick="downloadFile()"><i class="fas fa-download"></i> تنزيل الملف</button>
    </div>
    <div id="statusMessage" class="status-message"></div>
</div>

<script>
    
    const fileContent = `
    

// ======================================================
// الإختبار: إختبار_الاستخدام()
// وصف: شرح كفيفة الاستخدام 
// ======================================================
لو اختبار_الاستخدام
// أجعل اختبار_الاستخدام=1 من ringsyntax.ring ليعمل هذا الاختبار
شوف"بداية اختيار مخزن_خفيف" + سطر

 المحفوظات = أعمل مخزن_خفيف{
 الأتصال("المحفوظات")

تنفيذ( "#{إنشاء}  #{لولا} المنتج (رقم #{صحيح} #{أساس} , الأسم #{نص} , كمية #{صحيح} , السعر #{حقيقي})")


 }
 
  شوف :عرض_الكل + سطر
 البيانات = المحفوظات.تنفيذ( "#{أحضر} رقم , الأسم, كمية , السعر #{عن} المنتج")
  شوف البيانات
   شوف "تمت عرض الكل بنجاح ! " + سطر
 
 السعر=9 كمية=1 الأسم="اختيار المنتج"
  
  شوف :إضافة + سطر
   المحفوظات.تنفيذ( "#{أدخل} المنتج (الأسم, كمية, السعر) #{القيم} ('" + الأسم + "', '" + كمية + "', '" + السعر + "')")
   شوف "تمت الأضافة بنجاح ! " + سطر
  
  شوف :تعديل + سطر
   المحفوظات.تنفيذ( "#{تعديل} المنتج  #{أجعل} الأسم='" + الأسم + "' ,  السعر='" + السعر +"' , كمية='"+ كمية + "' #{عندما} رقم=1 ")
   شوف "تمت تعديل بنجاح ! " + سطر


شوف"نهاية اختيار مخزن_خفيف" + سطر
تم



// ======================================================
// وحدة: مخزن_خفيف
// وصف: طبقة مبسطة للتعامل مع SQLite باستخدام أوامر عربية
// ======================================================

وحدة مخزن_خفيف {

    // تحميل مكتبة SQLite الخاصة بـ Ring
    تحميل "sqlitelib.ring"

    // ==================================================
    // ثوابت أوامر SQL (مترجمة للعربية)
    // ==================================================
    القيم      = " VALUES "
    أدخل       = " INSERT INTO "
    تبديل      = " INSERT OR REPLACE INTO  "

    تعديل      = " UPDATE "
    أجعل       = " SET "

    أحذف       = " Delete From "
    أمسح       = " Delete From "
    مسح        = " Delete From "

    إنشاء      = " CREATE TABLE "
    لولا       = " IF NOT EXISTS "

    // أنواع البيانات
    صحيح       = " INTEGER "
    حقيقي      = " REAL "
    نص         = " TEXT "
    تاريخ      = " Datetime "
    علامة      = " Bit "
    أساس       = " PRIMARY KEY "
    مطلوب      = " NOT NULL "

    // أوامر الاستعلام
    أستعلم     = " SELECT "
    أشهد       = " SELECT "
    أحضر       = " SELECT "
    نسخ        = " INTO "
    ك          = " AS "
    بلقب       = " AS "
    عن         = " FROM "
    دمج        = " JOIN "
    شمال       = " LEFT OUTER "
    يسار       = " LEFT OUTER "
    يمين       = " RIGHT OUTER "
    نواة       = " INNER "
    جميع       = " FULL OUTER "
    لما        = " ON "
    عندما      = " WHERE "
    مثل        = " LIKE "
    داخل       = " IN "
    بين        = " BETWEEN "

    // التحكم في النتائج
    حد         = " LIMIT "
    تجميع      = " GROUP "
    ترتيب      = " ORDER "
    حسب        = " BY "
    بشرط       = " HAVING "
    تنزلي      = " DESC "
    تصاعدي     = " ASC "
    و          = " AND "
    أو         = " OR "
    عكس        = " NOT "

    // عمليات خاصة
    أحاد       = " DISTINCT "
    وحيد       = " DISTINCT "

    // دوال إحصائية
    أكبر       = " MAX "
    أضغر       = " MIN "
    متوسط      = " AVG "
    عدد        = " COUNT "
    مجموع      = " SUM "

    // ==================================================
    // متغيرات عامة
    // ==================================================
    اسم_المستخدم   = ""
    كلمة_المرور    = ""
    الضيف          = ""
    الجزء          = ""

    الجدول         = فارغ
    اسم_الجدول     = فارغ
    المخزن         = فارغ
    البيانات       = []
    المخزون        = []
    الأعمدة        = []
    حالة_الأتصال   = 0

    // ==================================================
    // دالة: إنشاء نوع عشري
    // ==================================================
    دالة عشري(الصحيح, جزء)
        مرر "DECIMAL(" + الصحيح + "," + جزء + ") "
    تمام

    // ==================================================
    // دالة: تنفيذ جملة SQL
    // ==================================================
    دالة تنفيذ الجملة
        الجملة = print2str(الجملة)
        مرر sqlite_execute(المخزن, الجملة)
    تمام

    // ==================================================
    // دالة: الاتصال بقاعدة البيانات
    // ==================================================
    دالة الأتصال اسم_المخزن
        لو isnull(المخزن)
            المخزن = sqlite_init()
            تنفيذ("SET CHARACTER SET utf8")
            أفتح_مخزن(اسم_المخزن)
            حالة_الأتصال = 1
        تم
        مرر حالة_الأتصال
    تمام



    // ==================================================
    // دالة: إنشاء الجدول تلقائياً حسب البيانات
    // ==================================================
    دالة الإنشاء

        ج_الإنشاء =
        " CREATE TABLE IF NOT EXISTS " + اسم_الجدول + " ( "

        ط_ب = طول(البيانات)

        من رقم = 1 إلى طول(الأعمدة)
            لو ط_ب >= رقم
                لو isnumber(البيانات[رقم])
                    لو isdigit("" + البيانات[رقم])
                        ج_الإنشاء += الأعمدة[رقم] + " INTEGER , "
                    لا
                        ج_الإنشاء += الأعمدة[رقم] + " DECIMAL(15,5) , "
                    تم
                لا
                    ج_الإنشاء += الأعمدة[رقم] + " VARCHAR(10000) , "
                تم
            لا
                ج_الإنشاء += الأعمدة[رقم] + " VARCHAR(10000) , "
            تم
        دور

        // إضافة المفتاح الأساسي
        ج_الإنشاء += " المعرف INTEGER PRIMARY KEY AUTOINCREMENT)"

        تنفيذ(ج_الإنشاء)
    تمام

    // ==================================================
    // دالة: حفظ سجل جديد
    // ==================================================
    دالة الحفظ بيان

        ج_الحفظ = أدخل + اسم_الجدول + " ( " + الأعمدة[1]

        من رقم_عمود = 2 إلى طول(الأعمدة)
            ج_الحفظ += " , " + الأعمدة[رقم_عمود]
        دور

        ج_الحفظ += ") " + القيم + " ( '"
        ج_الحفظ += بيان[1]

        من رقم = 2 إلى طول(بيان)
            ج_الحفظ += "','" + بيان[رقم]
        دور

        ج_الحفظ += "')"

        تنفيذ(ج_الحفظ)

        // تحديث الجدول بعد الحفظ
        هات_الكل()

        aLANGUAGE = []
        aLANGUAGE[:INFOS] = "المعلومات"
        aLANGUAGE[:RECORD_ADDED] = "تمت عملية الحفظ بنجاح"

        مرر 1
    تمام

    // ==================================================
    // دالة: جلب كل البيانات
    // ==================================================
    دالة هات_الكل
        مرر هات_البيانات("select * from " + اسم_الجدول + "; ")
    تمام

    // ==================================================
    // دالة: جلب عدد محدد من السجلات
    // ==================================================
    دالة هات_عدد(عدد)
        مرر هات_البيانات("select * from " + اسم_الجدول + " limit " + عدد + "; ")
    تمام

    // ==================================================
    // دالة: تنفيذ استعلام وجلب البيانات
    // ==================================================
    دالة هات_البيانات جملة_البحث

        ج_الكل = جملة_البحث
        المخزون = تنفيذ(ج_الكل)

        لو الجدول != فارغ && طول(المخزون) != 0

            طول_الأعمدة = طول(المخزون[1])
            الجدول.رأس_البيانات = []

            الجدول.setColumnCount(طول_الأعمدة)
            الجدول.ضع_بيانات(المخزون)

        تم

        مرر المخزون
    تمام

    // ==================================================
    // دالة: حذف صف محدد
    // ==================================================
    دالة أمسح الجدول, اسم_الجدول, اسم_المحدد

        ر_الصف = الجدول.CurrentRow()
        المحدد = Table.item(nrow,0).text()

        الجدول.removerow(ر_الصف)

        ج_المسح = "delete from " + اسم_الجدول + " where " + اسم_المحدد + " = " + المحدد
        sqlite_execute(المخزن, ج_المسح)

        هات_الكل()
    تمام

    // ==================================================
    // دالة: إغلاق قاعدة البيانات
    // ==================================================
    دالة الأغلاق
        sqlite_close(المخزن)
        المخزن = null
    تمام

    // ==================================================
    // دالة خاصة: فتح قاعدة البيانات
    // ==================================================
    خاص
    دالة أفتح_مخزن اسم_المخزن
        sqlite_open(المخزن, اسم_المخزن)
    تمام

}

`;

    const filename = 'مخزن_خفيف.ض';
    const statusMessageElement = document.getElementById('statusMessage');

    // عرض المحتوى في منطقة العرض عند تحميل الصفحة
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('fileContentDisplay').textContent = fileContent;
    });

    function showStatusMessage(message) {
        statusMessageElement.textContent = message;
        statusMessageElement.style.display = 'block';
        setTimeout(() => {
            statusMessageElement.style.display = 'none';
        }, 3000); // إخفاء الرسالة بعد 3 ثوانٍ
    }

    async function copyContent() {
        try {
            await navigator.clipboard.writeText(fileContent);
            showStatusMessage('تم نسخ المحتوى بنجاح!');
        } catch (err) {
            console.error('فشل في نسخ المحتوى: ', err);
            showStatusMessage('فشل في نسخ المحتوى.');
        }
    }

    function downloadFile() {
        const blob = new Blob([fileContent], { type: 'text/plain;charset=utf-8' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(a.href);
        showStatusMessage('جاري تنزيل الملف...');
    }
</script>

</body>
</html>
